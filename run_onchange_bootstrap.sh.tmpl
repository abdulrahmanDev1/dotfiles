#!/bin/bash

# .bootstrap/setup.yml hash: {{ include "dot_bootstrap/setup.yml" | sha256sum }}

if command -v ansible-playbook &>/dev/null; then
    ansible-playbook {{ joinPath .chezmoi.sourceDir "dot_bootstrap/setup.yml" | quote }} --ask-become-pass
fi

OS="$(uname -s)"
case "${OS}" in
Linux*)
    if [ -f /etc/fedora-release ]; then
        if command -v ansible-playbook &>/dev/null; then
            ansible-playbook {{ joinPath .chezmoi.sourceDir "dot_bootstrap/setup.yml" | quote }} --ask-become-pass
        fi
    elif [ -f /etc/lsb-release ]; then
        install_on_ubuntu
    elif [ -f /etc/arch-release ]; then
        install_on_arch
    else
        echo "Unsupported Linux distribution"
        exit 1
    fi
    ;;
Darwin*)
    install_on_mac
    ;;
*)
    echo "Unsupported operating system: ${OS}"
    exit 1
    ;;
esac
